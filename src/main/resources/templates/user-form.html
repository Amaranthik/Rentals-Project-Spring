<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background-color: #f3f4f6; font-family: system-ui, -apple-system, sans-serif; }
    .card { border: none; border-radius: 16px; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
    .form-label { font-weight: 600; color: #374151; margin-bottom: 8px; font-size: 0.95rem; }
    .form-control, .form-select { border-radius: 8px; padding: 12px 16px; border: 1px solid #d1d5db; }
    .form-control:focus { border-color: #2563eb; box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1); }
    .btn-dark { background-color: #1f2937; border-radius: 8px; padding: 12px 32px; font-weight: 600; }
    .btn-outline-secondary { border-radius: 8px; padding: 12px 24px; }
  </style>
</head>
<body>
<nav class="navbar navbar-dark bg-dark mb-5">
  <div class="container">
    <a class="navbar-brand fw-bold" href="/properties">üè† RENTALS SYSTEM</a>
  </div>
</nav>

<div class="container">
  <div class="row justify-content-center">
    <div class="col-lg-6">
      <div class="card bg-white p-5">
        <div class="mb-4 pb-3 border-bottom">
          <h2 class="fw-bold text-dark" th:text="${user.id} ? '–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è' : '–ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç'"></h2>
          <p class="text-muted mb-0">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–∏—Å—Ç–µ–º—ã.</p>
        </div>

        <form th:action="@{/users/save}" th:object="${user}" method="post">
          <input type="hidden" th:field="*{id}" />

          <div class="mb-4">
            <label class="form-label">–§–ò–û</label>
            <input type="text" th:field="*{fullName}" class="form-control" required />
          </div>

          <div class="mb-4">
            <label class="form-label">Email</label>
            <input type="email" th:field="*{email}" class="form-control" required />
          </div>

          <div class="mb-4">
            <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
            <!-- –î–æ–±–∞–≤–∏–ª–∏ id="phone" –∏ maxlength="12" -->
            <input type="tel" th:field="*{phone}" id="phone" class="form-control" placeholder="+7900..." maxlength="12" required />
            <div class="form-text">–¢–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã. –§–æ—Ä–º–∞—Ç: +7...</div>
          </div>

          <div class="mb-4">
            <label class="form-label">–†–æ–ª—å –≤ —Å–∏—Å—Ç–µ–º–µ</label>
            <select th:field="*{role}" class="form-select">
              <option value="Tenant">–ê—Ä–µ–Ω–¥–∞—Ç–æ—Ä (–°–Ω–∏–º–∞–µ—Ç)</option>
              <option value="Landlord">–ê—Ä–µ–Ω–¥–æ–¥–∞—Ç–µ–ª—å (–°–¥–∞–µ—Ç)</option>
            </select>
          </div>

          <div class="d-flex justify-content-end gap-3 mt-4">
            <a href="/users" class="btn btn-outline-secondary">–û—Ç–º–µ–Ω–∞</a>
            <button type="submit" class="btn btn-dark">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è –º–∞—Å–∫–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ -->
<script>
  const phoneInput = document.getElementById('phone');

  phoneInput.addEventListener('focus', function() {
    if (this.value === '') {
      this.value = '+7';
    }
  });

  phoneInput.addEventListener('input', function(e) {
    let value = this.value;

    if (!value.startsWith('+7')) {
      this.value = '+7';
      return;
    }

    const numericValue = value.substring(2).replace(/\D/g, '');
    this.value = '+7' + numericValue;
  });
</script>
</body>
</html>